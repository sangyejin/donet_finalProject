<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="noticeMapper">

	<resultMap id="noticeResultMap" type="Notice">
		<id column="no_no" property="noticeNo" />
		<result column="no_title" property="noticeTitle" />
		<result column="no_content" property="noticeContent" />
		<result column="no_date" property="noticeDate" />
		<result column="user_name" property="noticeWriter" />
		<result column="no_count" property="noticeCount" />
		<result column="no_save" property="noticeSave" />
		<result column="no_origin" property="noticeOrigin" />
		<result column="no_new" property="noticeNew" />
		
	</resultMap>
	
	

	<select id="selectNoticeListCount" resultType="_int" parameterType="Search">
		SELECT COUNT(*)
		FROM NOTICE
		JOIN MEMBER ON NO_WRITER=USER_ID
		WHERE NO_SAVE='N'
			<if test="writer != null">
			AND USER_NAME LIKE '%' || #{writer} || '%'
			</if>
			<if test="title != null">
			AND NO_TITLE LIKE '%' || #{title} || '%'
			</if>
			<if test="content != null">
			AND NO_CONTENT LIKE '%' || #{content} || '%'
			</if>
			
	</select>

	<select id="selectNoticeList" resultMap="noticeResultMap" parameterType="Search" resultType="Notice">
		SELECT NO_NO, NO_TITLE, NO_CONTENT, USER_NAME, NO_DATE, NO_COUNT, NO_ORIGIN, NO_NEW
		FROM NOTICE
        JOIN MEMBER ON NO_WRITER=USER_ID
		WHERE NO_SAVE='N' 
			<if test="writer != null">
			AND USER_NAME LIKE '%' || #{writer} || '%'
			</if>
			<if test="title != null">
			AND NO_TITLE LIKE '%' || #{title} || '%'
			</if>
			<if test="content != null">
			AND NO_CONTENT LIKE '%' || #{content} || '%'
			</if>
			
		ORDER BY NO_NO DESC
	</select>
	
	<update id="getCount" parameterType="_int">
		UPDATE NOTICE
		SET NO_COUNT = NO_COUNT+1
		WHERE NO_NO = #{noticeNo}
		AND NO_SAVE='N'
	</update>
	
	<select id="selectThisNotice" parameterType="_int" resultMap="noticeResultMap">
		SELECT NO_NO, NO_TITLE, NO_CONTENT, USER_NAME, NO_DATE, NO_COUNT, NO_ORIGIN, NO_NEW
		FROM NOTICE
        JOIN MEMBER ON NO_WRITER=USER_ID
		WHERE NO_NO = #{noticeNo}
		AND NO_SAVE='N'
	</select>
	
	<select id="selectPrevNotice" parameterType="_int" resultMap="noticeResultMap">
		<![CDATA[
		SELECT NO_NO, NO_TITLE
		FROM NOTICE
        JOIN MEMBER ON NO_WRITER=USER_ID
		WHERE NO_NO IN(	SELECT MAX(NO_NO)
						FROM NOTICE
        				JOIN MEMBER ON NO_WRITER=USER_ID
        				WHERE NO_SAVE='N'
        				AND NO_NO < #{noticeNo}
        				)
		]]>
	</select>
	
	<select id="selectNextNotice" parameterType="_int" resultMap="noticeResultMap">
		<![CDATA[ 
		SELECT NO_NO, NO_TITLE
		FROM NOTICE
        JOIN MEMBER ON NO_WRITER=USER_ID
		WHERE NO_NO IN(	SELECT MIN(NO_NO)
						FROM NOTICE
        				JOIN MEMBER ON NO_WRITER=USER_ID
        				WHERE NO_SAVE='N'
        				AND NO_NO > #{noNotice}
        				)
        ]]>
        				
	</select>
	
	<update id="deleteGo" parameterType="_int" >
		UPDATE NOTICE
		SET NO_SAVE='Y'
		WHERE NO_NO=#{noticeNo}
	</update>
	
	<insert id="insertNotice" parameterType="Notice">
	INSERT INTO NOTICE VALUES (SEQ_NOTICE.NEXTVAL,'도넷닷컴, 이렇게 사용하세요.','사는가 싶이 살았으며 그들의 그림자는 천고에 사라지지 않는 것이다 이것은 현저하게 일월과 같은 예가 되려니와 그와

봄바람이다 인생에 따뜻한 봄바람을 불어 보내는 것은 청춘의 끓는 피다 청춘의 피가 뜨거운지라 인간의 동산에는 사랑의 풀이 돋고 이상의 꽃이 피고 희망의 놀이 뜨고 열락의 새가 운다사랑의 풀이 없으면 인간은 사막이다 오아이스도 없는 사막이다 보이는 끝까지 찾아다녀도 목숨이 있는 때까지 방황하여도 보이는

실로 인간의 부패를 방지하는 소금이라 할지니 인생에 가치를 주는 원질이 되는 것이다 그들은 앞이 긴지라 착목한는 곳이 원대하고 그들은 피가 더운지라 실현에 대한 자신과 용기가 있다 그러므로 그들은',TO_DATE('18080815','YYYYMMDD'),'admin12',DEFAULT,DEFAULT,DEFAULT);
	
	
		INSERT INTO NOTICE
		VALUES
		(SEQ_NOTICE.NEXTVAL, #{noticeTitle}, #{noticeContent}, #{boardWriter},
		#{originName}, #{changeName},DEFAULT, DEFAULT, DEFAULT)
	</insert>
	
	

</mapper>